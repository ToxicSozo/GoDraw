# Reviewer Assignment Service

Сервис назначает ревьюверов для Pull Request'ов и предоставляет HTTP API для управления командами, пользователями и самим процессом ревью.

## Возможности

- Создание команды с указанием участников и их активности.
- Получение состава команды.
- Изменение активности пользователя.
- Создание Pull Request'ов с автоматическим назначением до двух активных ревьюверов из команды автора.
- Возврат флага `needMoreReviewers` в данных PR, если назначено меньше двух ревьюверов.
- Переназначение ревьюверов и получение списка PR'ов, назначенных конкретному пользователю.
- Идемпотентный merge PR.

## Запуск

### Локально

```bash
go run ./cmd/server
```

Сервис слушает порт `8080`.

### Docker Compose

```bash
docker-compose up --build
```

После запуска сервис также доступен на `http://localhost:8080`.

## Основные эндпоинты

| Метод | Путь | Описание |
|-------|------|----------|
| `POST` | `/team/add` | Создать команду и одновременно создать/обновить участников. |
| `GET` | `/team/get?team_name=<name>` | Получить состав команды. |
| `POST` | `/users/setIsActive` | Изменить флаг активности пользователя. |
| `POST` | `/pullRequest/create` | Создать PR и автоматически назначить до двух ревьюверов. |
| `POST` | `/pullRequest/merge` | Идемпотентно пометить PR как MERGED. |
| `POST` | `/pullRequest/reassign` | Переназначить ревьювера на активного участника его команды. |
| `GET` | `/users/getReview?user_id=<id>` | Получить PR'ы, назначенные пользователю. |

## Принятые допущения

- Пользователь может быть создан без команды. В этом случае при создании PR ревьюверы не назначаются.
- Переназначение ревьювера доступно только если существует активный кандидат в команде заменяемого ревьювера. В противном случае возвращается HTTP 409.
- После merge PR попытки переназначения ревьюверов возвращают HTTP 409.
- Все данные хранятся в памяти процесса. Для production-варианта потребуется постоянное хранилище.
